From 70653120cbd8ccb3fc042efefb20763913d47cce Mon Sep 17 00:00:00 2001
From: Mike Hommey <mh+mozilla@glandium.org>
Date: Tue, 9 Jun 2020 21:22:32 +0000
Subject: [PATCH] Bug 1622963 - Require python 3.6 for the build system.
 r=firefox-build-system-reviewers,rstewart

Differential Revision: https://phabricator.services.mozilla.com/D77754
---
 build/moz.configure/init.configure     | 12 ++++++------
 python/mozbuild/mozbuild/pythonutil.py |  2 +-
 python/mozbuild/mozbuild/virtualenv.py |  2 +-
 3 files changed, 8 insertions(+), 8 deletions(-)

--- a/build/moz.configure/init.configure
+++ b/build/moz.configure/init.configure
@@ -216,7 +216,7 @@ shell = help_shell | shell
 # Python 3
 # ========
 
-option(env="PYTHON3", nargs=1, help="Python 3 interpreter (3.6 or later)")
+option(env="PYTHON3", nargs=1, help="Python 3 interpreter (3.5 or later)")
 
 
 @depends("PYTHON3", check_build_environment, mozconfig, "--help")
@@ -318,7 +318,7 @@ def virtualenv_python3(env_python, build
             )
     else:
         # Fall back to the search routine.
-        python, version = find_python3_executable(min_version="3.6.0")
+        python, version = find_python3_executable(min_version="3.5.0")
 
         # The API returns a bytes whereas everything in configure is unicode.
         if python:
@@ -326,15 +326,15 @@ def virtualenv_python3(env_python, build
 
     if not python:
         raise FatalCheckError(
-            "Python 3.6 or newer is required to build. "
+            "Python 3.5 or newer is required to build. "
             "Ensure a `python3.x` executable is in your "
             "PATH or define PYTHON3 to point to a Python "
-            "3.6 executable."
+            "3.5 executable."
         )
 
-    if version < (3, 6, 0):
+    if version < (3, 5, 0):
         raise FatalCheckError(
-            "Python 3.6 or newer is required to build; "
+            "Python 3.5 or newer is required to build; "
             "%s is Python %d.%d" % (python, version[0], version[1])
         )
 
--- a/python/mozbuild/mozbuild/pythonutil.py
+++ b/python/mozbuild/mozbuild/pythonutil.py
@@ -44,7 +44,7 @@ def python_executable_version(exe):
 def _find_python_executable(major):
     if major not in (2, 3):
         raise ValueError("Expected a Python major version of 2 or 3")
-    min_versions = {2: "2.7.0", 3: "3.6.0"}
+    min_versions = {2: "2.7.0", 3: "3.5.0"}
 
     def ret(min_version=min_versions[major]):
         from mozfile import which
--- a/python/mozbuild/mozbuild/virtualenv.py
+++ b/python/mozbuild/mozbuild/virtualenv.py
@@ -648,7 +648,7 @@ def verify_python_version(log_handle):
     from distutils.version import LooseVersion
 
     major, minor, micro = sys.version_info[:3]
-    minimum_python_versions = {2: LooseVersion("2.7.3"), 3: LooseVersion("3.6.0")}
+    minimum_python_versions = {2: LooseVersion("2.7.3"), 3: LooseVersion("3.5.0")}
     our = LooseVersion("%d.%d.%d" % (major, minor, micro))
 
     if major not in minimum_python_versions or our < minimum_python_versions[major]:
